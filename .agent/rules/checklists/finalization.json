{
    "phases": [
        {
            "id": "finalization",
            "name": "Phase 5: Finalization",
            "status": "MANDATORY",
            "description": "Quality gates, atomic commits, TDD validation, and PR creation.",
            "checks": [
                {
                    "id": "git_clean",
                    "description": "Verify working tree is clean",
                    "type": "BLOCKER",
                    "validator": "check_git_status"
                },
                {
                    "id": "atomic_commits",
                    "description": "Validate atomic commit requirements and conventional format",
                    "type": "BLOCKER",
                    "validator": "validate_atomic_commits"
                },
                {
                    "id": "tdd_compliance",
                    "description": "Validate TDD compliance (implementation accompanied by tests)",
                    "type": "BLOCKER",
                    "validator": "validate_tdd_compliance"
                },
                {
                    "id": "reflection_invoked",
                    "description": "Verify structured reflection was captured (.reflection_input.json)",
                    "type": "BLOCKER",
                    "validator": "check_reflection_invoked"
                },
                {
                    "id": "handoff_compliance",
                    "description": "Verify hand-off documentation exists (.agent/handoffs/{issue-id}.md)",
                    "type": "BLOCKER",
                    "validator": "check_handoff_compliance"
                },
                {
                    "id": "handoff_cleanup",
                    "description": "Verify handoff file cleanup - files in .agent/handoffs/ will be deleted when issue is closed after PR merge",
                    "type": "WARNING",
                    "validator": "check_handoff_cleanup_info"
                },
                {
                    "id": "handoff_pr_verification",
                    "description": "Verify no orphaned or multiple open PRs for the task",
                    "type": "BLOCKER",
                    "validator": "check_handoff_pr_verification"
                },
                {
                    "id": "beads_pr_sync",
                    "description": "Verify PR references the active Beads issue",
                    "type": "BLOCKER",
                    "validator": "check_beads_pr_sync"
                },
                {
                    "id": "issue_closure_gate",
                    "description": "Verify issue is 'in_review' if PR is still open",
                    "type": "BLOCKER",
                    "validator": "check_issue_closure_gate"
                },
                {
                    "id": "no_separate_review_issues",
                    "description": "Verify NO separate Beads issues exist for code review",
                    "type": "BLOCKER",
                    "validator": "check_no_separate_review_issues"
                },
                {
                    "id": "pr_exists",
                    "description": "Verify Pull Request exists for code changes",
                    "type": "BLOCKER",
                    "validator": "check_pr_exists"
                },
                {
                    "id": "todo_completion",
                    "description": "Verify all tasks in task.md are completed",
                    "type": "BLOCKER",
                    "validator": "check_todo_completion"
                },
                {
                    "id": "pr_decomposition",
                    "description": "Verify decomposed PRs are properly closed",
                    "type": "BLOCKER",
                    "validator": "check_pr_decomposition_closure"
                },
                {
                    "id": "child_pr_linkage",
                    "description": "Verify child PRs reference parent issues",
                    "type": "BLOCKER",
                    "validator": "check_child_pr_linkage"
                },
                {
                    "id": "workspace_cleanup",
                    "description": "Verify the workspace is clean of temporary artifacts",
                    "type": "BLOCKER",
                    "validator": "check_workspace_cleanup"
                },
                {
                    "id": "beads_id_handoff",
                    "description": "Verify Beads issue ID in debrief.md",
                    "type": "BLOCKER",
                    "validator": "check_handoff_beads_id"
                },
                {
                    "id": "harness_session_finalization",
                    "description": "Verify active harness session",
                    "type": "BLOCKER",
                    "validator": "check_harness_session"
                },
                {
                    "id": "fix_details_documented",
                    "description": "Verify fix details (code changes, config updates) documented in issue comments",
                    "type": "BLOCKER",
                    "validator": "check_fix_details_documented"
                },
                {
                    "id": "verification_tests_listed",
                    "description": "Verify tests used for verification are documented in issue comments",
                    "type": "BLOCKER",
                    "validator": "check_verification_tests_listed"
                },
                {
                    "id": "related_issues_linked",
                    "description": "Verify related issues are linked in issue comments (optional)",
                    "type": "WARNING",
                    "validator": "check_related_issues_linked"
                },
                {
                    "id": "readme_needs_update",
                    "description": "Verify README is updated if session changes warrant documentation",
                    "type": "BLOCKER",
                    "validator": "check_readme_needs_update"
                }
            ]
        }
    ]
}